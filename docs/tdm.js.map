{"version":3,"file":"tdm.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/tdm/tdm.js","webpack://office-addin-taskpane-js/./src/tdm/tdm.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t168: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// Variables globales\r\nlet tocHelpShown = false; // Pour suivre si l'aide a déjà été affichée\r\n\r\n// Initialisation d'Office\r\nOffice.onReady((info) => {\r\n    // Office est prêt\r\n    if (info.host === Office.HostType.Word) {\r\n        // Initialiser les boutons\r\n        document.getElementById(\"generateBtn\").onclick = generateDocument;\r\n        document.getElementById(\"tocBtn\").onclick = showTableOfContentsHelp; // Changé pour l'aide\r\n        document.getElementById(\"validateBtn\").onclick = validateDocument;\r\n        \r\n        // Ajouter les dialogues au DOM\r\n        createConfirmDialog();\r\n        createHelpDialog();\r\n        \r\n        // Message de bienvenue\r\n        showStatus(\"✨ Complément chargé avec succès ! Prêt à générer votre document.\", \"info\");\r\n    }\r\n});\r\n\r\n// Créer le dialogue de confirmation personnalisé\r\nfunction createConfirmDialog() {\r\n    const dialogHTML = `\r\n        <div id=\"confirmDialog\" class=\"confirm-dialog-overlay\" style=\"display: none;\">\r\n            <div class=\"confirm-dialog\">\r\n                <div class=\"confirm-dialog-header\">\r\n                    <span class=\"confirm-dialog-icon\">⚠️</span>\r\n                    <h3>Confirmation requise</h3>\r\n                </div>\r\n                <div class=\"confirm-dialog-body\">\r\n                    <p id=\"confirmMessage\"></p>\r\n                </div>\r\n                <div class=\"confirm-dialog-footer\">\r\n                    <button id=\"confirmCancel\" class=\"btn-dialog btn-cancel\">Annuler</button>\r\n                    <button id=\"confirmOK\" class=\"btn-dialog btn-confirm\">Confirmer</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n    \r\n    document.body.insertAdjacentHTML('beforeend', dialogHTML);\r\n}\r\n\r\n// Créer le dialogue d'aide pour la table des matières\r\nfunction createHelpDialog() {\r\n    const helpHTML = `\r\n        <div id=\"helpDialog\" class=\"help-dialog-overlay\" style=\"display: none;\">\r\n            <div class=\"help-dialog\">\r\n                <div class=\"help-dialog-header\">\r\n                    <span class=\"help-dialog-icon\">💡</span>\r\n                    <h3>Aide : Insérer une table des matières</h3>\r\n                </div>\r\n                <div class=\"help-dialog-body\">\r\n                    <p><strong>C'est à vous de jouer !</strong></p>\r\n                    <p>Pour apprendre à utiliser Word efficacement, essayez d'insérer la table des matières par vous-même.</p>\r\n                    \r\n                    <div class=\"hint-box\">\r\n                        <h4>🔍 Indice :</h4>\r\n                        <p>Regardez dans l'onglet <strong>\"Références\"</strong> du ruban Word.</p>\r\n                        <p>Vous y trouverez un bouton <strong>\"Table des matières\"</strong>.</p>\r\n                    </div>\r\n                    \r\n                    <div class=\"steps-box\">\r\n                        <h4>📝 Étapes suggérées :</h4>\r\n                        <ol>\r\n                            <li>Positionnez votre curseur sous le titre \"Table des matières\"</li>\r\n                            <li>Allez dans l'onglet <strong>Références</strong></li>\r\n                            <li>Cliquez sur <strong>Table des matières</strong></li>\r\n                            <li>Choisissez un modèle qui affiche les numéros de page</li>\r\n                        </ol>\r\n                    </div>\r\n                    \r\n                    <p class=\"help-note\">💡 <em>Astuce : Choisissez un modèle automatique pour avoir des liens cliquables !</em></p>\r\n                </div>\r\n                <div class=\"help-dialog-footer\">\r\n                    <button id=\"helpOK\" class=\"btn-dialog btn-help-ok\">J'ai compris !</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `;\r\n    \r\n    document.body.insertAdjacentHTML('beforeend', helpHTML);\r\n    \r\n    // Ajouter les styles pour les dialogues\r\n    const dialogStyles = `\r\n        <style>\r\n        /* Styles du dialogue de confirmation */\r\n        .confirm-dialog-overlay, .help-dialog-overlay {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            z-index: 10000;\r\n            animation: fadeIn 0.2s ease;\r\n        }\r\n        \r\n        .confirm-dialog, .help-dialog {\r\n            background: white;\r\n            border-radius: 12px;\r\n            padding: 0;\r\n            width: 90%;\r\n            max-width: 450px;\r\n            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);\r\n            animation: slideUp 0.3s ease;\r\n            overflow: hidden;\r\n        }\r\n        \r\n        .confirm-dialog-header {\r\n            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\r\n            color: white;\r\n            padding: 20px;\r\n            text-align: center;\r\n        }\r\n        \r\n        .help-dialog-header {\r\n            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);\r\n            color: white;\r\n            padding: 10px;\r\n            text-align: center;\r\n        }\r\n        \r\n        .confirm-dialog-icon, .help-dialog-icon {\r\n            font-size: 48px;\r\n            display: block;\r\n            margin-bottom: 10px;\r\n        }\r\n        \r\n        .confirm-dialog-header h3, .help-dialog-header h3 {\r\n            margin: 0;\r\n            font-size: 20px;\r\n        }\r\n        \r\n        .confirm-dialog-body, .help-dialog-body {\r\n            padding: 15px;\r\n        }\r\n        \r\n        .confirm-dialog-body p, .help-dialog-body p {\r\n            margin: 10px 0;\r\n            line-height: 1.6;\r\n            color: #333;\r\n            font-size: 14px;\r\n        }\r\n        \r\n        .hint-box {\r\n            background: #e3f2fd;\r\n            border-left: 4px solid #2196F3;\r\n            padding: 10px;\r\n            margin: 20px 0;\r\n            border-radius: 8px;\r\n        }\r\n        \r\n        .hint-box h4 {\r\n            margin: 0 0 10px 0;\r\n            color: #1976D2;\r\n            font-size: 16px;\r\n        }\r\n        \r\n        .steps-box {\r\n            background: #f3e5f5;\r\n            border-left: 4px solid #9c27b0;\r\n            padding: 5px;\r\n            margin: 20px 0;\r\n            border-radius: 8px;\r\n        }\r\n        \r\n        .steps-box h4 {\r\n            margin: 0 0 10px 0;\r\n            color: #7b1fa2;\r\n            font-size: 16px;\r\n        }\r\n        \r\n        .steps-box ol {\r\n            margin: 10px 0 0 20px;\r\n            padding: 0;\r\n            color: #555;\r\n        }\r\n        \r\n        .steps-box li {\r\n            margin: 8px 0;\r\n            line-height: 1.5;\r\n        }\r\n        \r\n        .help-note {\r\n            background: #fff3e0;\r\n            padding: 10px;\r\n            border-radius: 6px;\r\n            margin-top: 15px;\r\n        }\r\n        \r\n        .confirm-dialog-footer, .help-dialog-footer {\r\n            display: flex;\r\n            gap: 10px;\r\n            padding: 15px 20px;\r\n            background: #f8f9fa;\r\n            justify-content: flex-end;\r\n        }\r\n        \r\n        .btn-dialog {\r\n            padding: 10px 20px;\r\n            border: none;\r\n            border-radius: 8px;\r\n            font-size: 14px;\r\n            font-weight: 500;\r\n            cursor: pointer;\r\n            transition: all 0.2s ease;\r\n        }\r\n        \r\n        .btn-cancel {\r\n            background: #e9ecef;\r\n            color: #495057;\r\n        }\r\n        \r\n        .btn-cancel:hover {\r\n            background: #dee2e6;\r\n        }\r\n        \r\n        .btn-confirm {\r\n            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);\r\n            color: white;\r\n        }\r\n        \r\n        .btn-help-ok {\r\n            background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);\r\n            color: white;\r\n            min-width: 120px;\r\n        }\r\n        \r\n        .btn-confirm:hover, .btn-help-ok:hover {\r\n            transform: translateY(-2px);\r\n            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);\r\n        }\r\n        \r\n        @keyframes fadeIn {\r\n            from { opacity: 0; }\r\n            to { opacity: 1; }\r\n        }\r\n        \r\n        @keyframes slideUp {\r\n            from { \r\n                transform: translateY(20px);\r\n                opacity: 0;\r\n            }\r\n            to { \r\n                transform: translateY(0);\r\n                opacity: 1;\r\n            }\r\n        }\r\n        </style>\r\n    `;\r\n    \r\n    document.head.insertAdjacentHTML('beforeend', dialogStyles);\r\n}\r\n\r\n// Fonction pour afficher le dialogue de confirmation\r\nfunction showConfirmDialog(message) {\r\n    return new Promise((resolve) => {\r\n        const dialog = document.getElementById('confirmDialog');\r\n        const messageEl = document.getElementById('confirmMessage');\r\n        const cancelBtn = document.getElementById('confirmCancel');\r\n        const okBtn = document.getElementById('confirmOK');\r\n        \r\n        messageEl.innerHTML = message;\r\n        dialog.style.display = 'flex';\r\n        \r\n        function handleCancel() {\r\n            dialog.style.display = 'none';\r\n            cancelBtn.removeEventListener('click', handleCancel);\r\n            okBtn.removeEventListener('click', handleOK);\r\n            resolve(false);\r\n        }\r\n        \r\n        function handleOK() {\r\n            dialog.style.display = 'none';\r\n            cancelBtn.removeEventListener('click', handleCancel);\r\n            okBtn.removeEventListener('click', handleOK);\r\n            resolve(true);\r\n        }\r\n        \r\n        cancelBtn.addEventListener('click', handleCancel);\r\n        okBtn.addEventListener('click', handleOK);\r\n    });\r\n}\r\n\r\n// Fonction pour afficher l'aide de la table des matières\r\nfunction showTableOfContentsHelp() {\r\n    const dialog = document.getElementById('helpDialog');\r\n    const okBtn = document.getElementById('helpOK');\r\n    \r\n    dialog.style.display = 'flex';\r\n    \r\n    function handleOK() {\r\n        dialog.style.display = 'none';\r\n        okBtn.removeEventListener('click', handleOK);\r\n        tocHelpShown = true;\r\n        \r\n        // Changer le texte du bouton après la première aide\r\n        const tocBtn = document.getElementById('tocBtn');\r\n        const btnText = tocBtn.querySelector('span:nth-child(2)');\r\n        if (btnText) {\r\n            btnText.textContent = \"Afficher l'aide à nouveau\";\r\n        }\r\n        \r\n        showStatus(\"💪 À vous de jouer ! Utilisez l'onglet Références pour insérer la table des matières.\", \"info\");\r\n    }\r\n    \r\n    okBtn.addEventListener('click', handleOK);\r\n}\r\n\r\n// Fonction pour générer le document\r\nasync function generateDocument() {\r\n    const loader = document.getElementById(\"generateLoader\");\r\n    const btn = document.getElementById(\"generateBtn\");\r\n    \r\n    try {\r\n        loader.style.display = \"inline-block\";\r\n        btn.disabled = true;\r\n        \r\n        await Word.run(async (context) => {\r\n            const body = context.document.body;\r\n            \r\n            // Charger le contenu pour vérifier s'il est vide\r\n            body.load(\"text\");\r\n            await context.sync();\r\n            \r\n            // Si le document n'est pas vide, demander confirmation\r\n            if (body.text.trim().length > 0) {\r\n                const confirmDelete = await showConfirmDialog(\r\n                    \"<strong>Attention : Le document actuel n'est pas vide.</strong><br><br>\" +\r\n                    \"Voulez-vous effacer tout le contenu existant et générer un nouveau document ?<br><br>\" +\r\n                    \"<em>Cette action est irréversible.</em>\"\r\n                );\r\n                \r\n                if (!confirmDelete) {\r\n                    showStatus(\"Génération annulée. Le document existant a été conservé.\", \"info\");\r\n                    loader.style.display = \"none\";\r\n                    btn.disabled = false;\r\n                    return;\r\n                }\r\n                body.clear();\r\n            }\r\n            \r\n            // Générer le contenu du document\r\n            await generateDocumentContent(body);\r\n            \r\n            await context.sync();\r\n            \r\n            // Afficher les détails du document\r\n            document.getElementById(\"documentDetails\").style.display = \"block\";\r\n            \r\n            showStatus(\r\n                \"✅ Document généré avec succès ! \" +\r\n                \"Maintenant, utilisez l'onglet Références pour insérer la table des matières manuellement.\",\r\n                \"success\"\r\n            );\r\n        });\r\n    } catch (error) {\r\n        console.error(\"Erreur:\", error);\r\n        showStatus(\"❌ Erreur lors de la génération : \" + error.message, \"error\");\r\n    } finally {\r\n        loader.style.display = \"none\";\r\n        btn.disabled = false;\r\n    }\r\n}\r\n\r\n// Fonction pour générer le contenu du document (sans changement)\r\nasync function generateDocumentContent(body) {\r\n    // Page de garde\r\n    const coverTitle = body.insertParagraph(documentContent.coverPage.title, Word.InsertLocation.start);\r\n    coverTitle.styleBuiltIn = Word.Style.title;\r\n    coverTitle.alignment = Word.Alignment.centered;\r\n    coverTitle.spaceAfter = 200;\r\n    \r\n    const coverSubtitle = body.insertParagraph(documentContent.coverPage.subtitle, Word.InsertLocation.end);\r\n    coverSubtitle.alignment = Word.Alignment.centered;\r\n    coverSubtitle.font.size = 18;\r\n    coverSubtitle.font.color = \"#4a5568\";\r\n    coverSubtitle.spaceAfter = 100;\r\n    \r\n    const coverDate = body.insertParagraph(documentContent.coverPage.date, Word.InsertLocation.end);\r\n    coverDate.alignment = Word.Alignment.centered;\r\n    coverDate.font.size = 14;\r\n    coverDate.font.color = \"#718096\";\r\n    \r\n    // Saut de page après la page de garde\r\n    body.insertBreak(Word.BreakType.page, Word.InsertLocation.end);\r\n    \r\n    // // Table des matières (titre seulement)\r\n    // const tocTitle = body.insertParagraph(\"Table des matières\", Word.InsertLocation.end);\r\n    // tocTitle.styleBuiltIn = Word.Style.heading1;\r\n    // tocTitle.spaceAfter = 30;\r\n    \r\n    // Note pour l'utilisateur\r\n    const tocPlaceholder = body.insertParagraph(\r\n        \"[Insérez la table des matières ici!]\",\r\n        Word.InsertLocation.end\r\n    );\r\n    tocPlaceholder.font.italic = true;\r\n    tocPlaceholder.font.color = \"#999999\";\r\n    tocPlaceholder.alignment = Word.Alignment.left;\r\n    \r\n    // Saut de page\r\n    body.insertBreak(Word.BreakType.page, Word.InsertLocation.end);\r\n    \r\n    // Générer les chapitres\r\n    documentContent.chapters.forEach((chapter, chapterIndex) => {\r\n        // Titre du chapitre\r\n        const chapterTitle = body.insertParagraph(chapter.title, Word.InsertLocation.end);\r\n        chapterTitle.styleBuiltIn = Word.Style.heading1;\r\n        chapterTitle.spaceAfter = 15;\r\n        \r\n        // Introduction du chapitre\r\n        if (chapter.introduction) {\r\n            const intro = body.insertParagraph(chapter.introduction, Word.InsertLocation.end);\r\n            intro.styleBuiltIn = Word.Style.normal;\r\n            intro.spaceAfter = 20;\r\n        }\r\n        \r\n        // Sections du chapitre\r\n        chapter.sections.forEach(section => {\r\n            // Titre de la section\r\n            const sectionTitle = body.insertParagraph(section.title, Word.InsertLocation.end);\r\n            sectionTitle.styleBuiltIn = Word.Style.heading2;\r\n            sectionTitle.spaceAfter = 10;\r\n            \r\n            // Contenu de la section\r\n            const sectionContent = body.insertParagraph(section.content, Word.InsertLocation.end);\r\n            sectionContent.styleBuiltIn = Word.Style.normal;\r\n            sectionContent.spaceAfter = 15;\r\n            \r\n            // Sous-sections\r\n            if (section.subsections) {\r\n                section.subsections.forEach(subsection => {\r\n                    const subsectionTitle = body.insertParagraph(subsection.title, Word.InsertLocation.end);\r\n                    subsectionTitle.styleBuiltIn = Word.Style.heading3;\r\n                    subsectionTitle.spaceAfter = 8;\r\n                    \r\n                    const subsectionContent = body.insertParagraph(subsection.content, Word.InsertLocation.end);\r\n                    subsectionContent.styleBuiltIn = Word.Style.normal;\r\n                    subsectionContent.spaceAfter = 15;\r\n                });\r\n            }\r\n        });\r\n        \r\n        // Saut de page après chaque chapitre (sauf le dernier)\r\n        if (chapterIndex < documentContent.chapters.length - 1) {\r\n            body.insertBreak(Word.BreakType.page, Word.InsertLocation.end);\r\n        }\r\n    });\r\n    \r\n    // Conclusion\r\n    body.insertBreak(Word.BreakType.page, Word.InsertLocation.end);\r\n    const conclusionTitle = body.insertParagraph(documentContent.conclusion.title, Word.InsertLocation.end);\r\n    conclusionTitle.styleBuiltIn = Word.Style.heading1;\r\n    conclusionTitle.spaceAfter = 15;\r\n    \r\n    const conclusionText = body.insertParagraph(documentContent.conclusion.content, Word.InsertLocation.end);\r\n    conclusionText.styleBuiltIn = Word.Style.normal;\r\n    \r\n    // Note de source\r\n    body.insertBreak(Word.BreakType.page, Word.InsertLocation.end);\r\n    const sourceNote = body.insertParagraph(documentContent.source, Word.InsertLocation.end);\r\n    sourceNote.font.italic = true;\r\n    sourceNote.font.size = 10;\r\n    sourceNote.font.color = \"#666666\";\r\n    sourceNote.alignment = Word.Alignment.centered;\r\n}\r\n\r\n// Fonction de validation du document - MODIFIÉE\r\nasync function validateDocument() {\r\n    const loader = document.getElementById(\"validateLoader\");\r\n    const btn = document.getElementById(\"validateBtn\");\r\n    \r\n    try {\r\n        loader.style.display = \"inline-block\";\r\n        btn.disabled = true;\r\n        \r\n        await Word.run(async (context) => {\r\n            const body = context.document.body;\r\n            let validationResults = [];\r\n            \r\n            // Test 1: Vérifier la présence du titre \"Table des matières\"\r\n            const tocTitleSearch = context.document.body.search(\"Table des matières\", {\r\n                matchCase: false\r\n            });\r\n            tocTitleSearch.load(\"items\");\r\n            await context.sync();\r\n            \r\n            const hasTocTitle = tocTitleSearch.items.length > 0;\r\n            validationResults.push({\r\n                check: \"Titre 'Table des matières' présent\",\r\n                passed: hasTocTitle,\r\n                message: hasTocTitle ? \r\n                    \"Le titre 'Table des matières' est présent\" : \r\n                    \"Le titre 'Table des matières' n'a pas été trouvé\"\r\n            });\r\n            \r\n            // Test 2: Vérifier que le placeholder a été remplacé par une vraie table\r\n            const placeholderSearch = context.document.body.search(\"[Insérez la table des matières ici\", {\r\n                matchCase: false\r\n            });\r\n            placeholderSearch.load(\"items\");\r\n            await context.sync();\r\n            \r\n            const placeholderRemoved = placeholderSearch.items.length === 0;\r\n            validationResults.push({\r\n                check: \"Table des matières insérée\",\r\n                passed: placeholderRemoved,\r\n                message: placeholderRemoved ? \r\n                    \"Une table des matières a été insérée\" : \r\n                    \"Le placeholder est toujours présent - Utilisez l'onglet Références\"\r\n            });\r\n            \r\n            // Test 3: Vérifier la présence de numéros de page (recherche de patterns typiques)\r\n            let hasPageNumbers = false;\r\n            if (placeholderRemoved && hasTocTitle) {\r\n                // Rechercher des patterns de numéros de page (ex: \"...3\", \"... 3\", points de suite)\r\n                const dotsSearch = context.document.body.search(\".\", {\r\n                    matchCase: false,\r\n                    matchWildcards: true\r\n                });\r\n                dotsSearch.load(\"items\");\r\n                \r\n                // Rechercher des numéros après le titre TdM\r\n                const numberPatterns = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\"];\r\n                let foundNumbers = false;\r\n                \r\n                for (const num of numberPatterns) {\r\n                    const numSearch = context.document.body.search(num, {\r\n                        matchCase: false\r\n                    });\r\n                    numSearch.load(\"items\");\r\n                    await context.sync();\r\n                    if (numSearch.items.length > 0) {\r\n                        foundNumbers = true;\r\n                        break;\r\n                    }\r\n                }\r\n                \r\n                hasPageNumbers = foundNumbers;\r\n            }\r\n            \r\n            validationResults.push({\r\n                check: \"Numéros de page affichés\",\r\n                passed: hasPageNumbers,\r\n                message: hasPageNumbers ? \r\n                    \"La table des matières affiche des numéros de page\" : \r\n                    \"Les numéros de page ne sont pas visibles - Choisissez un modèle avec numéros\"\r\n            });\r\n            \r\n            // Test 4: Vérifier l'emplacement (sous le titre)\r\n            let correctPosition = false;\r\n            if (placeholderRemoved && hasTocTitle) {\r\n                // Si le placeholder est supprimé et qu'il y a du contenu, c'est probablement bien placé\r\n                correctPosition = true;\r\n            }\r\n            \r\n            validationResults.push({\r\n                check: \"Table au bon emplacement\",\r\n                passed: correctPosition,\r\n                message: correctPosition ? \r\n                    \"La table est positionnée sous le titre 'Table des matières'\" : \r\n                    \"La table n'est pas au bon emplacement\"\r\n            });\r\n            \r\n            // Test 5: Vérifier les liens actifs (difficile à tester programmatiquement)\r\n            // On vérifie si c'est une vraie table Word en cherchant des champs TOC\r\n            let hasActiveLinks = false;\r\n            if (placeholderRemoved) {\r\n                // Si une vraie table des matières Word est insérée, elle contient généralement\r\n                // des références aux titres du document\r\n                const headingRefs = [\"Introduction\", \"Applications\", \"Défis\"];\r\n                let foundRefs = 0;\r\n                \r\n                for (const ref of headingRefs) {\r\n                    const refSearch = context.document.body.search(ref, {\r\n                        matchCase: false\r\n                    });\r\n                    refSearch.load(\"items\");\r\n                    await context.sync();\r\n                    // Si on trouve le terme plusieurs fois, c'est probablement dans la TdM + le contenu\r\n                    if (refSearch.items.length > 1) {\r\n                        foundRefs++;\r\n                    }\r\n                }\r\n                \r\n                hasActiveLinks = foundRefs >= 2; // Au moins 2 références trouvées\r\n            }\r\n            \r\n            validationResults.push({\r\n                check: \"Liens cliquables (modèle automatique)\",\r\n                passed: hasActiveLinks,\r\n                message: hasActiveLinks ? \r\n                    \"La table semble utiliser un modèle automatique avec liens\" : \r\n                    \"Utilisez un modèle automatique pour avoir des liens cliquables\"\r\n            });\r\n            \r\n            // Afficher les résultats\r\n            displayValidationResults(validationResults);\r\n            \r\n            // Calculer le score global\r\n            const passedCount = validationResults.filter(r => r.passed).length;\r\n            const totalCount = validationResults.length;\r\n            const percentage = Math.round((passedCount / totalCount) * 100);\r\n            \r\n            if (percentage === 100) {\r\n                showStatus(\r\n                    `✅ Excellent ! Tous les ${totalCount} critères sont validés. ` +\r\n                    \"La table des matières est parfaitement configurée.\",\r\n                    \"success\"\r\n                );\r\n            } else if (percentage >= 60) {\r\n                showStatus(\r\n                    `⚠️ Presque parfait : ${passedCount}/${totalCount} critères validés (${percentage}%). ` +\r\n                    \"Vérifiez les points manquants.\",\r\n                    \"warning\"\r\n                );\r\n            } else {\r\n                showStatus(\r\n                    `❌ Incomplet : ${passedCount}/${totalCount} critères validés (${percentage}%). ` +\r\n                    \"Utilisez l'onglet Références pour insérer une table des matières automatique.\",\r\n                    \"error\"\r\n                );\r\n            }\r\n        });\r\n    } catch (error) {\r\n        console.error(\"Erreur:\", error);\r\n        showStatus(\"❌ Erreur lors de la validation : \" + error.message, \"error\");\r\n    } finally {\r\n        loader.style.display = \"none\";\r\n        btn.disabled = false;\r\n    }\r\n}\r\n\r\n// Fonction pour afficher les résultats de validation\r\nfunction displayValidationResults(results) {\r\n    const resultsDiv = document.getElementById(\"validationResults\");\r\n    const contentDiv = document.getElementById(\"validationContent\");\r\n    \r\n    // Vider le contenu précédent\r\n    contentDiv.innerHTML = \"\";\r\n    \r\n    // Créer les éléments de résultat\r\n    results.forEach(result => {\r\n        const item = document.createElement(\"div\");\r\n        item.className = \"validation-item\";\r\n        \r\n        const icon = document.createElement(\"span\");\r\n        icon.className = result.passed ? \"check-icon\" : \"cross-icon\";\r\n        icon.textContent = result.passed ? \"✓\" : \"✗\";\r\n        \r\n        const text = document.createElement(\"span\");\r\n        text.innerHTML = `<strong>${result.check}</strong><br>\r\n                         <small style=\"color: #666; font-size: 11px;\">${result.message}</small>`;\r\n        \r\n        item.appendChild(icon);\r\n        item.appendChild(text);\r\n        contentDiv.appendChild(item);\r\n    });\r\n    \r\n    // Afficher la section des résultats\r\n    resultsDiv.style.display = \"block\";\r\n    \r\n    // Ajouter une animation\r\n    resultsDiv.style.animation = \"slideIn 0.3s ease\";\r\n}\r\n\r\n// Fonction pour afficher les messages de statut\r\nfunction showStatus(message, type) {\r\n    const statusDiv = document.getElementById(\"statusMessage\");\r\n    \r\n    // Définir le contenu et la classe\r\n    statusDiv.textContent = message;\r\n    statusDiv.className = \"status-message status-\" + type;\r\n    statusDiv.style.display = \"block\";\r\n    \r\n    // Animation d'apparition\r\n    statusDiv.style.animation = \"slideIn 0.3s ease\";\r\n    \r\n    // Auto-masquer après un délai pour certains types\r\n    if (type === \"success\" || type === \"info\") {\r\n        setTimeout(() => {\r\n            statusDiv.style.animation = \"fadeOut 0.3s ease\";\r\n            setTimeout(() => {\r\n                statusDiv.style.display = \"none\";\r\n            }, 300);\r\n        }, 7000);\r\n    }\r\n}\r\n\r\n// Ajouter l'animation fadeOut dans le style\r\nconst style = document.createElement(\"style\");\r\nstyle.textContent = `\r\n    @keyframes fadeOut {\r\n        from { opacity: 1; }\r\n        to { opacity: 0; }\r\n    }\r\n`;\r\ndocument.head.appendChild(style);\r\n\r\n// Gestion des erreurs globales\r\nwindow.onerror = function(msg, url, lineNo, columnNo, error) {\r\n    console.error('Erreur globale:', error);\r\n    showStatus(\"❌ Une erreur inattendue s'est produite. Veuillez réessayer.\", \"error\");\r\n    return false;\r\n};","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./tdm.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./document-content.js\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"./tdm.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html lang=\\\"fr\\\"> <head> <meta charset=\\\"UTF-8\\\"> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Exercice Table des Matières - Word</title> <link rel=\\\"stylesheet\\\" href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"> </head> <body> <div class=\\\"container\\\"> <div class=\\\"header\\\"> <h1> <span class=\\\"icon-book\\\">📚</span> Exercice Table des Matières </h1> <p>Apprenez à créer une table des matières dans Word</p> </div> <div class=\\\"content\\\"> <div class=\\\"action-section\\\"> <h2> <span class=\\\"icon\\\">📝</span> Étape 1: Génération du Document </h2> <div class=\\\"button-group\\\"> <button id=\\\"generateBtn\\\" class=\\\"btn btn-primary\\\"> <span class=\\\"icon\\\">📄</span> <span>Générer le document complet</span> <span id=\\\"generateLoader\\\" class=\\\"loading\\\" style=\\\"display:none\\\"></span> </button> </div> <div class=\\\"info-text\\\"> Crée un document de plusieurs pages avec une structure hiérarchique complète </div> </div> <div class=\\\"action-section\\\"> <h2> <span class=\\\"icon\\\">💡</span> Étape 2: Aide Table des Matières </h2> <div class=\\\"button-group\\\"> <button id=\\\"tocBtn\\\" class=\\\"btn btn-success\\\"> <span class=\\\"icon\\\">❓</span> <span>Obtenir de l'aide</span> <span id=\\\"tocLoader\\\" class=\\\"loading\\\" style=\\\"display:none\\\"></span> </button> </div> <div class=\\\"info-text\\\"> Découvrez comment insérer manuellement une table des matières </div> </div> <div class=\\\"action-section\\\"> <h2> <span class=\\\"icon\\\">✅</span> Étape 3: Validation </h2> <div class=\\\"button-group\\\"> <button id=\\\"validateBtn\\\" class=\\\"btn btn-info\\\"> <span class=\\\"icon\\\">🔍</span> <span>Valider la table des matières</span> <span id=\\\"validateLoader\\\" class=\\\"loading\\\" style=\\\"display:none\\\"></span> </button> </div> <div class=\\\"info-text\\\"> Vérifie que la table des matières est correctement insérée </div> </div> <div class=\\\"info-box\\\"> <h3>🎯 Objectif de l'exercice</h3> <ul> <li><strong>Apprendre</strong> à utiliser les fonctionnalités natives de Word</li> <li><strong>Générer</strong> un document structuré avec des styles de titres</li> <li><strong>Insérer manuellement</strong> une table des matières via l'onglet Références</li> <li><strong>Choisir</strong> un modèle avec numéros de page et liens cliquables</li> <li><strong>Valider</strong> que la table est correctement configurée</li> </ul> </div> <div id=\\\"statusMessage\\\" class=\\\"status-message\\\"></div> <div id=\\\"validationResults\\\" class=\\\"validation-results\\\" style=\\\"display:none\\\"> <h3>📊 Résultats de la validation :</h3> <div id=\\\"validationContent\\\"></div> </div> <div class=\\\"validation-criteria\\\" style=\\\"display:none\\\" id=\\\"validationCriteria\\\"> <h3>📋 Critères de validation</h3> <p>Votre table des matières doit :</p> <ul> <li>✓ Être présente sous le titre \\\"Table des matières\\\"</li> <li>✓ Afficher les numéros de page</li> <li>✓ Utiliser un modèle automatique (liens cliquables)</li> <li>✓ Être à jour avec tous les titres du document</li> </ul> </div> <div id=\\\"documentDetails\\\" class=\\\"document-details\\\" style=\\\"display:none\\\"> <h3>📊 Structure du document généré</h3> <ul> <li><strong>Pages :</strong> 7 pages au total</li> <li><strong>Page 1 :</strong> Page de garde</li> <li><strong>Page 2 :</strong> Emplacement pour la table des matières</li> <li><strong>Pages 3-5 :</strong> 3 chapitres avec sections et sous-sections</li> <li><strong>Page 6 :</strong> Conclusion</li> <li><strong>Page 7 :</strong> Sources et références</li> <li><strong>Styles utilisés :</strong> Titre 1, Titre 2, Titre 3</li> </ul> </div> </div> <div class=\\\"footer\\\"> <p><strong>Exercice Word - Table des Matières</strong></p> <p>© 2025 - Formation Office Add-in</p> <p class=\\\"source-note\\\">Apprenez à utiliser les fonctionnalités natives de Word</p> </div> </div> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_2___ + \"\\\"><\" + \"/script> <\" + \"script>document.addEventListener(\\\"DOMContentLoaded\\\",function(){const t=document.getElementById(\\\"generateBtn\\\");if(t){const e=t.onclick;t.onclick=async function(){e&&await e(),setTimeout(()=>{const t=document.getElementById(\\\"validationCriteria\\\");t&&(t.style.display=\\\"block\\\")},1e3)}}})<\" + \"/script> </body> </html>\";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","tocHelpShown","showTableOfContentsHelp","dialog","getElementById","okBtn","style","display","addEventListener","handleOK","removeEventListener","btnText","querySelector","textContent","showStatus","async","generateDocument","loader","btn","disabled","Word","run","body","context","load","sync","text","trim","Promise","resolve","messageEl","cancelBtn","handleCancel","innerHTML","clear","coverTitle","insertParagraph","documentContent","coverPage","title","InsertLocation","start","styleBuiltIn","Style","alignment","Alignment","centered","spaceAfter","coverSubtitle","subtitle","end","font","size","color","coverDate","date","insertBreak","BreakType","page","tocPlaceholder","italic","left","chapters","forEach","chapter","chapterIndex","chapterTitle","heading1","introduction","intro","normal","sections","section","sectionTitle","heading2","sectionContent","content","subsections","subsection","subsectionTitle","heading3","subsectionContent","conclusionTitle","conclusion","sourceNote","source","generateDocumentContent","error","console","message","validateDocument","validationResults","tocTitleSearch","search","matchCase","hasTocTitle","items","push","check","passed","placeholderSearch","placeholderRemoved","hasPageNumbers","matchWildcards","numberPatterns","foundNumbers","num","numSearch","correctPosition","hasActiveLinks","headingRefs","foundRefs","ref","refSearch","results","resultsDiv","contentDiv","result","item","createElement","className","icon","appendChild","animation","displayValidationResults","passedCount","filter","r","totalCount","percentage","Math","round","type","statusDiv","setTimeout","Office","onReady","info","host","HostType","onclick","insertAdjacentHTML","head","createHelpDialog","onerror","msg","url","lineNo","columnNo","URL"],"sourceRoot":""}